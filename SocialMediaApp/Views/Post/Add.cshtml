@using EntityLayer;
@model PostGenreLocationUserModel;
@{
    ViewData["Title"] = "Add";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}
<div class="card">
    <div class="card-header">
        <h2>Post Add</h2>
    </div>
    <div class="card-body">
        @using (Html.BeginForm("Add", "Post", FormMethod.Post, new { @class = "form-group", @enctype = "multipart/form-data" }))
        {
            @Html.Label("Creator NickName")
            <select class="form-control" name="UserId">
                @foreach (var item in Model.UserModel)
                {
                    <option value="@item.UserId">@item.NickName</option>
                }
            </select>
            <br />
            @Html.Label("Generate Date")
            @Html.TextBox("GenerateDate","",new { @class = "form-control",@type="date"})
            @Html.ValidationMessage("GenerateDate","",new{@class="text-danger"})
            <br />
            @Html.Label("Post ImgFile")
            <input id="image_file" type="file" name="imgFiles" class="form-control" accept="image/*" onchange="changeContent()" multiple />
            @Html.ValidationMessage("imgFiles","",new{@class="text-danger"})
            <br />
            <div style="display:flex;justify-content:space-around;">
                <div style="border:1px dashed black;padding:5px;width:30%;padding:10px;">
                    <img id="imageDisplay1" src="https://flashresim.com/blog/wp-content/uploads/2019/03/resim-yukleme-sitesi-280x227.png" width="100%" height="250px" /><br>
                    <label id="imageName1"></label><br>
                    <label id="imageSize1"></label>
                </div>
                <div style="border:1px dashed black;padding:5px;width:30%;padding:10px;">
                    <img id="imageDisplay2" src="https://flashresim.com/blog/wp-content/uploads/2019/03/resim-yukleme-sitesi-280x227.png" width="100%" height="250px" /><br>
                    <label id="imageName2"></label><br>
                    <label id="imageSize2"></label>
                </div>
                <div style="border:1px dashed black;padding:5px;width:30%;padding:10px;">
                    <img id="imageDisplay3" src="https://flashresim.com/blog/wp-content/uploads/2019/03/resim-yukleme-sitesi-280x227.png" width="100%" height="250px" /><br>
                    <label id="imageName3"></label><br>
                    <label id="imageSize3"></label>
                </div>
            </div>
            <br />
            @Html.Label("Description")
            @Html.TextBox("Description","",new { @class = "form-control"})
            @Html.ValidationMessage("Description","",new{@class="text-danger"})
            <br />
            @Html.Label("Location Name")
            <select class="form-control" name="LocationId">
                @foreach (var item in Model.LocationModel)
                {
                    <option value="@item.LocationId">@item.LocationName</option>
                }
            </select>
            <br />
            @Html.Label("Genre Name")
            <select class="form-control" name="GenreId">
                @foreach (var item in Model.GenreModel)
                {
                    <option value="@item.GenreId">@item.GenreName</option>
                }
            </select>
            <br />
            @Html.Label("IsActive")
            <select class="form-control" name="IsActive">
                <option value="True">Aktif</option>
                <option value="False">Pasif</option>
            </select>
            <br />
            <input id="addBtn" class="form-control btn btn-primary" type="submit" value="Post Add" />
        }
    </div>
</div>

<!--File Upload -->
<script>

    function changeContent() {
        var btn = document.getElementById('addBtn');
        var selectedImgCounts = document.getElementById('image_file').files.length;
        console.log(selectedImgCounts);

        switch (selectedImgCounts) {
            case 1:

                var file1 = document.getElementById('image_file').files[0];
                var sizeLabel1 = document.getElementById('imageSize1');
                document.getElementById('imageDisplay1').src = window.URL.createObjectURL(file1);
                document.getElementById('imageName1').innerHTML = file1.name;

                if (file1.size > 819200) {
                    sizeLabel1.innerHTML = "Cannot be more than 800 kilobytes";
                    sizeLabel1.style.color = "red";
                    btn.disabled = true;
                } else {
                    sizeLabel1.innerHTML = returnFileSize(file1.size);
                    sizeLabel1.style.color = "black";
                    btn.disabled = false;
                }
                
                break;
            case 2:
                var file1 = document.getElementById('image_file').files[0];
                var sizeLabel1 = document.getElementById('imageSize1');
                document.getElementById('imageDisplay1').src = window.URL.createObjectURL(file1);
                document.getElementById('imageName1').innerHTML = file1.name;

                var file2 = document.getElementById('image_file').files[1];
                var sizeLabel2 = document.getElementById('imageSize2');
                document.getElementById('imageDisplay2').src = window.URL.createObjectURL(file2);
                document.getElementById('imageName2').innerHTML = file2.name;

                if (file1.size > 819200) {
                    sizeLabel1.innerHTML = "Cannot be more than 800 kilobytes";
                    sizeLabel1.style.color = "red";
                    btn.disabled = true;
                } else {
                    sizeLabel1.innerHTML = returnFileSize(file1.size);
                    sizeLabel1.style.color = "black";
                    btn.disabled = false;
                }
                if (file2.size > 819200) {
                    sizeLabel2.innerHTML = "Cannot be more than 800 kilobytes";
                    sizeLabel2.style.color = "red";
                    btn.disabled = true;
                } else {
                    sizeLabel2.innerHTML = returnFileSize(file2.size);
                    sizeLabel2.style.color = "black";
                    btn.disabled = false;
                }
                break;
            case 3:
                var file1 = document.getElementById('image_file').files[0];
                var sizeLabel1 = document.getElementById('imageSize1');
                document.getElementById('imageDisplay1').src = window.URL.createObjectURL(file1);
                document.getElementById('imageName1').innerHTML = file1.name;

                var file2 = document.getElementById('image_file').files[1];
                var sizeLabel2 = document.getElementById('imageSize2');
                document.getElementById('imageDisplay2').src = window.URL.createObjectURL(file2);
                document.getElementById('imageName2').innerHTML = file2.name;

                var file3 = document.getElementById('image_file').files[2];
                var sizeLabel3 = document.getElementById('imageSize3');
                document.getElementById('imageDisplay3').src = window.URL.createObjectURL(file3);
                document.getElementById('imageName3').innerHTML = file3.name;

                if (file1.size > 819200) {
                    sizeLabel1.innerHTML = "Cannot be more than 800 kilobytes";
                    sizeLabel1.style.color = "red";
                    btn.disabled = true;
                } else {
                    sizeLabel1.innerHTML = returnFileSize(file1.size);
                    sizeLabel1.style.color = "black";
                    btn.disabled = false;
                }
                if (file2.size > 819200) {
                    sizeLabel2.innerHTML = "Cannot be more than 800 kilobytes";
                    sizeLabel2.style.color = "red";
                    btn.disabled = true;
                } else {
                    sizeLabel2.innerHTML = returnFileSize(file2.size);
                    sizeLabel2.style.color = "black";
                    btn.disabled = false;
                }
                if (file3.size > 819200) {
                    sizeLabel3.innerHTML = "Cannot be more than 800 kilobytes";
                    sizeLabel3.style.color = "red";
                    btn.disabled = true;
                } else {
                    sizeLabel3.innerHTML = returnFileSize(file3.size);
                    sizeLabel3.style.color = "black";
                    btn.disabled = false;
                }
                break;
        }
    }
            File Size
            function returnFileSize(number) {
                if (number < 1024) {
                    return `${number} bytes`;
                } else if (number >= 1024 && number < 1048576) {
                    return `${(number / 1024).toFixed(1)} KB`;
                } else if (number >= 1048576) {
                    return `${(number / 1048576).toFixed(1)} MB`;
                }
            }
</script>